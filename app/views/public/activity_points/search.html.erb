<div class="container-field">
  <div class= "row" >
    <div class="col-3 guide-content left">
      <%= search_form_for @search do |f| %>
      <div class="row search-box">
        <h5 class="col-12 mb-3">æ¤œç´¢ã—ã¾ã—ã‚‡ã†</h5>

        <div class="col-12 mb-1">
          <%= f.collection_select :prefecture_eq, JpPrefecture::Prefecture.all, :name, :name, { include_blank: 'éƒ½é“åºœçœŒ' }, { class: 'custom-select' } %>
        </div>
        <div class="col-12 mb-1">
          <%= f.search_field :spot_or_address_cont, placeholder: "ä½æ‰€ã¾ãŸã¯ã‚¹ãƒãƒƒãƒˆå", class: 'form-control' %>
        </div>
        <div class="col-7   mb-1">
          <%= f.date_field :date_cont, class: 'form-control' %>
        </div>
        <div class="col-7  mb-3">
          <%= f.time_field :time_gteq, include_blank: true, class: 'form-control' %>
        </div>
        <div class="col-12 mb-3">
          <%= f.radio_button :activity_status_eq, '', {:checked => true} %>æŒ‡å®šãªã—</br>
          <%= f.radio_button :activity_status_eq, 0 %>ã‚«ãƒ¡ãƒ©ãƒãƒ³</br>
          <%= f.radio_button :activity_status_eq, 1 %>ãƒ¢ãƒ‡ãƒ«
        </div>
        <div class="col-12 mb-3">
          <%= f.submit 'ğŸ”ã€€ã“ã®æ¡ä»¶ã§æ¤œç´¢ï¼', class: 'button ' %>
        </div>
      <% end %>

      <div id='map'></div>

      <script>
        let map

            // æ¤œç´¢çµæœã‚ˆã‚Šåœ°å›³ã®è¡¨ç¤º
            function initMap() {
                geocoder = new google.maps.Geocoder()

                var LatLng ={lat: <%= @activity_point.latitude %>, lng: <%= @activity_point.longitude %>};
                map = new google.maps.Map(document.getElementById('map'), {
                    center: LatLng,
                    zoom: 12,
                });

            // æ´»å‹•åœ°ç‚¹ã®addressã‹ã‚‰ç·¯åº¦çµŒåº¦ã‚’å–å¾—
            <% @activity_points.each do |m| %>
              (function(){
                // ç·¯åº¦çµŒåº¦ã‚’å…ƒã«ãƒ”ãƒ³ã‚’ã•ã™
                  var marker = new google.maps.Marker({
                      position:{lat: <%= m.latitude %>, lng: <%= m.longitude %>},
                      map: map
                  });
                })();
            <% end %>
            }

      </script>
      <script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_API_KEY'] %>&callback=initMap" async defer></script>
  </div>
</div>



    <div class="col-8 main-content fixed">
      <div class="sort-table">
        <div><%=  link_to "å…¨ä»¶è¡¨ç¤º", activity_points_path, class: 'button sort' %></div>
        <div><%=  sort_link @search, :date, "æ—¥ä»˜é †", class: 'button sort' %></div>
        <div><%=  sort_link @search, :time, "æ™‚é–“é †", class: 'button sort' %></div>
      </div>
        <div class="jscroll-div search">
          <div class='jscroll-container table table-hover table-inverse'>
                <% @activity_points.each do |activity_point| %>
                <div class="row searchuser-box">
                    <div class="col-2 ml-4 my-5">
                      <%= image_tag activity_point.user.get_profile_image, class: "table-img" %>
                    </div>
                    <div class="col-7 my-5  section">
                      <p>
                        <strong>
                          <%= activity_point.user.nickname %>

                          <!--ãƒãƒƒãƒãƒ³ã‚°ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º-->
                          <% if activity_point.user.following?(current_user) && activity_point.user.follower?(current_user) %>
                            <i class="fas fa-solid fa-hand-holding-heart"></i>
                            ãƒãƒƒãƒãƒ³ã‚°æ¸ˆã¿
                          <!--ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¾é ¼ã‚’é€ã£ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ã‚¢ã‚¤ã‚³ãƒ³è¡¨ç¤º-->
                          <% elsif activity_point.user.following?(current_user) %>
                            <i class="fas fa-solid fa-hand-holding"></i>
                            ãƒ•ã‚©ãƒ­ãƒ¼ä¾é ¼ãŒå±Šã„ã¦ã„ã¾ã™
                          <% else %>
                            <!--ã©ã¡ã‚‰ã§ã‚‚ãªã„å ´åˆã¯ç©ºç™½-->
                          <% end %></br>

                        </strong>
                      </p>
                      <p>
                        <span class="pr-3">æ´»å‹•æ—¥æ™‚ï¼š</span><%= activity_point.date.strftime('%mæœˆ%dæ—¥') %>  <%= activity_point.time.strftime('%H:%M') %></br>
                      </p>
                      <p>
                        <span class="pr-3">ã‚¹ãƒãƒƒãƒˆï¼š</span><%= activity_point.spot %></br>
                      </p>
                      <p>
                        <span class="pr-3">æ´»å‹•ä½æ‰€ï¼š</span><%= activity_point.prefecture %><%= activity_point.address %></br>
                      </p>
                      <p>
                        <span class="pr-5">è¦æœ›ï¼š</span><p><%= activity_point.request %></p>
                      </p>
                    </div>
                    <div class="col-2 my-5">
                      <%= link_to 'è©³ç´°ç”»é¢ã¸', matching_user_path(activity_point.user), class: "header-button search" %>
                    </div>
                </div>
                <% end %>
          <%= paginate @activity_points %>
        </div>
      </div>
    </div>
  </div>
</div>








<!--ã‚¹ãƒ©ã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼-->
<!--<div id="slideL" class="off">-->
<!--    <div class="slide-inner">-->
<!--    </div>-->
<!--</div>-->
<!--< javascript_pack_tag 'slide_menu' %>-->