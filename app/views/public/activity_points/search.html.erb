
<div class="container-field">
      <div class= "row" >
        <div class="col-3 guide-content left">
            <%= search_form_for @search do |f| %>
            <div class="row search-box">
              <h5 class="col-12 mb-3">Ê§úÁ¥¢„Åó„Åæ„Åó„Çá„ÅÜ</h5>

              <div class="col-12 mb-1">
                <%= f.collection_select :prefecture_eq, JpPrefecture::Prefecture.all, :name, :name, { include_blank: 'ÈÉΩÈÅìÂ∫úÁúå' }, { class: 'custom-select' } %>
              </div>
              <div class="col-12 mb-1">
                <%= f.search_field :spot_or_address_cont, placeholder: "‰ΩèÊâÄ„Åæ„Åü„ÅØ„Çπ„Éù„ÉÉ„ÉàÂêç", class: 'form-control' %>
              </div>
              <div class="col-7   mb-1">
                <%= f.date_field :date_cont, class: 'form-control' %>
              </div>
              <div class="col-7  mb-3">
                <%= f.time_field :time_gteq, include_blank: true, class: 'form-control' %>
              </div>
              <div class="col-12 mb-3">
                <%= f.radio_button :activity_status_eq, '', {:checked => true} %>ÊåáÂÆö„Å™„Åó</br>
                <%= f.radio_button :activity_status_eq, 0 %>„Ç´„É°„É©„Éû„É≥</br>
                <%= f.radio_button :activity_status_eq, 1 %>„É¢„Éá„É´
              </div>
              <div class="col-12">
                <%= f.submit 'üîç„ÄÄ„Åì„ÅÆÊù°‰ª∂„ÅßÊ§úÁ¥¢ÔºÅ', class: 'button' %>
              </div>
            <% end %>

            <h2>gmap</h2>
            <div id='map'></div>

            <style>
            #map{
              height: 400px;
              width: 100%;
            }
            </style>

            <script>
              let map

                  function initMap() {
                      map = new google.maps.Map(document.getElementById("map"), {
                          center:{lat: 35.68123620000001, lng:139.7671248},
                          zoom: 12,
                      });
                  }

                  <% @activity_points.each do |m| %>
                    <% results = Geocoder.search(m.address) %>
                    <% if results.present? %>
                      <% @latlng = results.first.coordinates %>

                      (function() {
                        let marker = new google.maps.Marker({
                            position:{lat: <%= @latlng[0] %>, lng: <%= @latlng[1] %>},
                            map: map
                        });
                      })();
                    <% end %>
                  <% end %>
            </script>
            <script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_API_KEY'] %>&callback=initMap" async defer></script>
        </div>
      </div>



          <div class="col-8 main-content fixed">
            <div class="sort-table">
              <div><%=  link_to "ÂÖ®‰ª∂Ë°®Á§∫", activity_points_path, class: 'button sort' %></div>
              <div><%=  sort_link @search, :date, "Êó•‰ªòÈ†Ü", class: 'button sort' %></div>
              <div><%=  sort_link @search, :time, "ÊôÇÈñìÈ†Ü", class: 'button sort' %></div>
            </div>
            <div class="jscroll-div search">
              <div class='jscroll-container table table-hover table-inverse'>
                    <% @activity_points.each do |activity_point| %>
                    <div class="row searchuser-box">
                        <div class="col-2 ml-4 my-5">
                          <%= image_tag activity_point.user.get_profile_image, class: "table-img" %>
                        </div>
                        <div class="col-7 my-5  section">
                          <p>
                            <strong>
                              <%= activity_point.user.nickname %>

                              <!--„Éû„ÉÉ„ÉÅ„É≥„Ç∞„Åó„Å¶„ÅÑ„Çã„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„Ç§„Ç≥„É≥Ë°®Á§∫-->
                              <% if activity_point.user.following?(current_user) && activity_point.user.follower?(current_user) %>
                                <i class="fas fa-solid fa-hand-holding-heart"></i>
                                „Éû„ÉÉ„ÉÅ„É≥„Ç∞Ê∏à„Åø
                              <!--„É≠„Ç∞„Ç§„É≥„É¶„Éº„Ç∂„Éº„Å´‰æùÈ†º„ÇíÈÄÅ„Å£„Åü„É¶„Éº„Ç∂„Éº„ÅÆ„Åø„Ç¢„Ç§„Ç≥„É≥Ë°®Á§∫-->
                              <% elsif activity_point.user.following?(current_user) %>
                                <i class="fas fa-solid fa-hand-holding"></i>
                                „Éï„Ç©„É≠„Éº‰æùÈ†º„ÅåÂ±ä„ÅÑ„Å¶„ÅÑ„Åæ„Åô
                              <% else %>
                                <!--„Å©„Å°„Çâ„Åß„ÇÇ„Å™„ÅÑÂ†¥Âêà„ÅØÁ©∫ÁôΩ-->
                              <% end %></br>

                            </strong>
                          </p>
                          <p>
                            <span class="pr-3">Ê¥ªÂãïÊó•ÊôÇÔºö</span><%= activity_point.date.strftime('%mÊúà%dÊó•') %>  <%= activity_point.time.strftime('%H:%M') %></br>
                          </p>
                          <p>
                            <span class="pr-3">„Çπ„Éù„ÉÉ„ÉàÔºö</span><%= activity_point.spot %></br>
                          </p>
                          <p>
                            <span class="pr-3">Ê¥ªÂãï‰ΩèÊâÄÔºö</span><%= activity_point.prefecture %><%= activity_point.address %></br>
                          </p>
                          <p>
                            <span class="pr-5">Ë¶ÅÊúõÔºö</span><p><%= activity_point.request %></p>
                          </p>
                        </div>
                        <div class="col-2 my-5">
                          <%= link_to 'Ë©≥Á¥∞ÁîªÈù¢„Å∏', matching_user_path(activity_point.user), class: "header-button search" %>
                        </div>
                    </div>
                    <% end %>
              <%= paginate @activity_points %>
            </div>
        </div>
  </div>
</div>


